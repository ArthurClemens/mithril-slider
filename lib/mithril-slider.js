"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var _mithril=require("mithril"),_mithril2=_interopRequireDefault(_mithril),_hammerjs=require("hammerjs"),_hammerjs2=_interopRequireDefault(_hammerjs),createView=function(t,e){var n=t.contentEl(),r=t.list(),a=t.index();return t.groupBy(e.groupBy||1),n&&t.updateContentSize(n),(0,_mithril2.default)("div",{class:["slider",e.class||""].join(" ")},e.before?(0,_mithril2.default)(".before",e.before):null,(0,_mithril2.default)(".content",{config:function(r,a,i){if(!a){t.setContentEl(r);var n=new _hammerjs2.default.Manager(r,{});n.add(new _hammerjs2.default.Pan({orientation:"vertical"===e.orientation?_hammerjs2.default.DIRECTION_VERTICAL:_hammerjs2.default.DIRECTION_HORIZONTAL,threshold:0})),n.on("panmove",t.handleDrag),n.on("panend",t.handleDragEnd),n.on("panstart",t.handleDragStart),i.onunload=function(){n.off("panmove",t.handleDrag),n.off("panend",t.handleDragEnd),n.off("panstart",t.handleDragStart)}}}},r.map(function(t,n){return e.page({data:t,listIndex:n,currentIndex:a})})),e.after?(0,_mithril2.default)(".after",e.after):null)},slider={};slider.controller=function(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],d=parseInt(n.duration,10)||160,t=_mithril2.default.prop(n.index||0),r=n.pageData();r.then(_mithril2.default.redraw);var e=_mithril2.default.prop(),f=0,u=_mithril2.default.prop(n.groupBy||1),D=n.cancelDragFactor||.2,a="vertical"===n.orientation,h=n.rtl?-1:1,_=function(e){t(e),_mithril2.default.redraw()},g=function(t,e){return t.childNodes[e]},c=function(n,e){var t=n.style,r=function(){var t=a?"0":e+"px",n=a?e+"px":"0",r="0",i=[t,n,r].join(", ");return"translate3d("+i+")"};t.transform=t["-webkit-transform"]=t["-moz-transform"]=t["-ms-transform"]=r()},o=function(t){e().style["-webkit-transition-duration"]=e().style["transition-duration"]=t+"ms"},l=function(t,n){0>t||t>r().length-1||(void 0!==n&&o(n),c(e(),-h*t*f),_(t))},i=function(o){var l=t(),e=u(),a=0,i=r().length,n=l+o*e;return n+e>i?i-e:a>n?a:n},m=function(t){var n=t.childNodes[0],e=a?"height":"width";f=n.getBoundingClientRect()[e],t.style[e]=r().length*f+"px"},s=function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0];m(e()),o(t),l(i(0))},p=function(){var e=arguments.length<=0||void 0===arguments[0]?d:arguments[0];return o(e),l(t()<r().length?i(1):i(0))},v=function(){var e=arguments.length<=0||void 0===arguments[0]?d:arguments[0];return o(e),l(t()>0?i(-1):i(0))},x=function(){return t()+u()<r().length},j=function(){return t()>0},C=function(t){e(t),m(t),s(0)},w=function(){return o(0)},y=function(r){var i=e(),n=g(i,t()),o=a?r.deltaY:r.deltaX,l=a?n.offsetTop:-1===h?n.offsetLeft-n.parentNode.clientWidth+n.clientWidth:n.offsetLeft;c(i,o-l),r.preventDefault()},E=function(r){var a=e(),i=g(a,t()),o=i.clientWidth,l=Math.abs(r)||1,n=1/l*o;return n>d&&(n=d),n},I=function(t){var e=E(t.velocity),n=a?t.deltaY:t.deltaX;Math.abs(n)>f*u()*D?0>h*n?p(e):v(e):s(e)};return{list:r,contentEl:e,setContentEl:C,handleDrag:y,handleDragStart:w,handleDragEnd:I,groupBy:u,updateContentSize:m,index:t,hasNext:x,hasPrevious:j,goTo:l,goCurrent:s,goNext:p,goPrevious:v}},slider.view=function(e,t){return t.sliderController&&t.sliderController(e),createView(e,t)},exports.default=slider,module.exports=exports.default;