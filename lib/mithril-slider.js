"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var _mithril=require("mithril"),_mithril2=_interopRequireDefault(_mithril),_hammerjs=require("hammerjs"),_hammerjs2=_interopRequireDefault(_hammerjs),createView=function(t,e){var n=t.contentEl(),r=t.list(),a=t.index();return t.groupBy(e.groupBy||1),n&&t.updateContentSize(n),(0,_mithril2.default)("div",{class:["slider",e.class||""].join(" ")},e.before?(0,_mithril2.default)(".before",e.before):null,(0,_mithril2.default)(".content",{config:function(r,a,i){if(!a){t.setContentEl(r);var n=new _hammerjs2.default.Manager(r,{});n.add(new _hammerjs2.default.Pan({orientation:"vertical"===e.orientation?_hammerjs2.default.DIRECTION_VERTICAL:_hammerjs2.default.DIRECTION_HORIZONTAL,threshold:0})),n.on("panmove",t.handleDrag),n.on("panend",t.handleDragEnd),n.on("panstart",t.handleDragStart),i.onunload=function(){n.off("panmove",t.handleDrag),n.off("panend",t.handleDragEnd),n.off("panstart",t.handleDragStart)}}}},r.map(function(t,n){return e.page({data:t,listIndex:n,currentIndex:a})})),e.after?(0,_mithril2.default)(".after",e.after):null)},slider={};slider.controller=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],l=parseInt(e.duration,10)||250,t=_mithril2.default.prop(e.index||0),n=e.pageData();n.then(_mithril2.default.redraw);var r=_mithril2.default.prop(),d=0,f=_mithril2.default.prop(e.groupBy||1),_=e.cancelDragFactor||.2,a="vertical"===e.orientation,h=e.rtl?-1:1,D=function(e){t(e),_mithril2.default.redraw()},v=function(t,e){return t.childNodes[e]},c=function(n,e){var t=n.style,r=function(){var t=a?"0":e+"px",n=a?e+"px":"0",r="0",i=[t,n,r].join(", ");return"translate3d("+i+")"};t.transform=t["-webkit-transform"]=t["-moz-transform"]=t["-ms-transform"]=r()},o=function(t){r().style["-webkit-transition-duration"]=r().style["transition-duration"]=t+"ms"},u=function(t,e){0>t||t>n().length-1||(void 0!==e&&o(e),c(r(),-h*t*d),D(t))},i=function(o){var l=t(),e=f(),a=0,i=n().length,r=l+o*e;return r+e>i?i-e:a>r?a:r},m=function(t){var r=t.childNodes[0],e=a?"height":"width";d=r.getBoundingClientRect()[e],t.style[e]=n().length*d+"px"},s=function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0];m(r()),o(t),u(i(0))},g=function(){var e=arguments.length<=0||void 0===arguments[0]?l:arguments[0];return o(e),u(t()<n().length?i(1):i(0))},p=function(){var e=arguments.length<=0||void 0===arguments[0]?l:arguments[0];return o(e),u(t()>0?i(-1):i(0))},x=function(){return t()+f()<n().length},j=function(){return t()>0},C=function(t){r(t),m(t),s(0)},w=function(){return o(0)},y=function(n){var i=r(),e=v(i,t()),o=a?n.deltaY:n.deltaX,l=a?e.offsetTop:-1===h?e.offsetLeft-e.parentNode.clientWidth+e.clientWidth:e.offsetLeft;c(i,o-l),n.preventDefault()},E=function(e){var n=Math.abs(e),t=1/n*360;return 80>t&&(t=80),t>l&&(t=l),t},I=function(t){var e=E(t.velocity),n=a?t.deltaY:t.deltaX;Math.abs(n)>d*f()*_?0>h*n?g(e):p(e):s(e)};return{list:n,contentEl:r,setContentEl:C,handleDrag:y,handleDragStart:w,handleDragEnd:I,groupBy:f,updateContentSize:m,index:t,hasNext:x,hasPrevious:j,goTo:u,goCurrent:s,goNext:g,goPrevious:p}},slider.view=function(e,t){return t.sliderController&&t.sliderController(e),createView(e,t)},exports.default=slider,module.exports=exports.default;