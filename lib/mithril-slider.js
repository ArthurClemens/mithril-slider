"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var _mithril=require("mithril"),_mithril2=_interopRequireDefault(_mithril),_hammerjs=require("hammerjs"),_hammerjs2=_interopRequireDefault(_hammerjs),createView=function(t,e){var n=t.contentEl(),r=t.list(),a=t.index();return t.groupBy(e.groupBy||1),n&&t.updateContentSize(n),(0,_mithril2.default)("div",{class:["slider",e.class||""].join(" ")},e.before?(0,_mithril2.default)(".before",e.before):null,(0,_mithril2.default)(".content",{config:function(r,a,i){if(!a){t.setContentEl(r);var n=new _hammerjs2.default.Manager(r,{});n.add(new _hammerjs2.default.Pan({orientation:"vertical"===e.orientation?_hammerjs2.default.DIRECTION_VERTICAL:_hammerjs2.default.DIRECTION_HORIZONTAL,threshold:0})),n.on("panmove",t.handleDrag),n.on("panend",t.handleDragEnd),n.on("panstart",t.handleDragStart),i.onunload=function(){n.off("panmove",t.handleDrag),n.off("panend",t.handleDragEnd),n.off("panstart",t.handleDragStart)}}}},r.map(function(t,n){return e.page({data:t,listIndex:n,currentIndex:a})})),e.after?(0,_mithril2.default)(".after",e.after):null)},slider={};slider.controller=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],l=parseInt(e.duration,10)||250,t=_mithril2.default.prop(e.index||0),r=e.pageData(),n=_mithril2.default.prop(),d=0,s=_mithril2.default.prop(e.groupBy||1),_=e.cancelDragFactor||.2,a="vertical"===e.orientation,h=e.rtl?-1:1,D=function(e){t(e)},v=function(t,e){return t.childNodes[e]},c=function(n,e){var t=n.style,r=function(){var t=a?"0":e+"px",n=a?e+"px":"0",r="0",i=[t,n,r].join(", ");return"translate3d("+i+")"};t.transform=t["-webkit-transform"]=t["-moz-transform"]=t["-ms-transform"]=r()},o=function(t){n().style["-webkit-transition-duration"]=n().style["transition-duration"]=t+"ms"},u=function(t,e){0>t||t>r().length-1||(void 0!==e&&o(e),c(n(),-h*t*d),D(t))},i=function(o){var l=t(),e=s(),a=0,i=r().length,n=l+o*e;return n+e>i?i-e:a>n?a:n},m=function(t){var n=t.childNodes[0],e=a?"height":"width";d=n.getBoundingClientRect()[e],t.style[e]=r().length*d+"px"},f=function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0];m(n()),o(t),u(i(0))},g=function(){var e=arguments.length<=0||void 0===arguments[0]?l:arguments[0];return o(e),u(t()<r().length?i(1):i(0))},p=function(){var e=arguments.length<=0||void 0===arguments[0]?l:arguments[0];return o(e),u(t()>0?i(-1):i(0))},x=function(){return t()+s()<r().length},j=function(){return t()>0},C=function(t){n(t),m(t),f(0)},y=function(){return o(0)},E=function(r){var i=n(),e=v(i,t()),o=a?r.deltaY:r.deltaX,l=a?e.offsetTop:-1===h?e.offsetLeft-e.parentNode.clientWidth+e.clientWidth:e.offsetLeft;c(i,o-l),r.preventDefault()},I=function(e){var n=Math.abs(e),t=1/n*360;return 80>t&&(t=80),t>l&&(t=l),t},b=function(t){var e=I(t.velocity),n=a?t.deltaY:t.deltaX;Math.abs(n)>d*s()*_?0>h*n?g(e):p(e):f(e)};return{list:r,contentEl:n,setContentEl:C,handleDrag:E,handleDragStart:y,handleDragEnd:b,groupBy:s,updateContentSize:m,index:t,hasNext:x,hasPrevious:j,goTo:u,goCurrent:f,goNext:g,goPrevious:p}},slider.view=function(e,t){return t.sliderController&&t.sliderController(e),createView(e,t)},exports.default=slider,module.exports=exports.default;